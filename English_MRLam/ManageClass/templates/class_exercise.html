{% extends "base-admin.html" %}

{% block title %}Bài tập{% endblock %}

{% block content %}
<style>
    .custom-title {
        font-size: 1.8rem;
        font-weight: 700;
        color: #5c6bc0;
        border-bottom: 2px solid;
        margin: 1.5rem 0 1rem;
        padding: 8px 0;
    }
</style>
<div class="container-fluid tab-section">
    <h2 class="custom-title">Danh sách lớp học > Lớp {{ class_instance.class_name }}</h2>

    <ul class="nav nav-tabs mb-3">
        <li class="nav-item">
            <a class="nav-link" href="{% url 'class_detail' class_id=class_instance.pk %}">Mô tả lớp học</a>
        </li>
        <li class="nav-item">
            <a class="nav-link active" href="{% url 'class_exercise' class_id=class_instance.pk %}">Bài tập</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="{% url 'class_rollcall' class_id=class_instance.pk %}">Điểm danh</a>
        </li>
    </ul>

    <div class="d-flex justify-content-between mb-3">
        <input type="text" class="form-control w-25" placeholder="Search exercise">
        <div class="d-flex gap-2">
            <select class="form-select">
                <option>Chọn bài tập</option>
                <!-- Thêm các option bài tập nếu cần -->
            </select>
            <select class="form-select">
                <option>Chọn trạng thái</option>
                <option>Đã chấm</option>
                <option>Chưa chấm</option>
            </select>
        </div>
    </div>

    <table class="table table-bordered">
        <thead class="table-light text-center">
            <tr>
                <th>ID</th>
                <th>Họ và tên</th>
                <th>Bài tập</th>
                <th>Trạng thái</th>
                <th>Ngày nộp</th>
            </tr>
        </thead>
        <tbody class="text-center">
            {% for submission in submissions %}
            <tr>
                <!-- Kiểm tra submission.id trước khi tạo liên kết -->
                <td>
                    {% if submission.id %}
                        <a href="{% url 'exercise_detail' class_id=class_instance.pk submission_id=submission.id %}">{{ submission.userclass.user.id }}</a>
                    {% else %}
                        {{ submission.userclass.user.id }}
                    {% endif %}
                </td>
                <td>{{ submission.userclass.user.first_name }} {{ submission.userclass.user.last_name }}</td>
                <td>{{ submission.exercise.lessondetail.lesson.lesson_name }}</td>
                <td>
                    {% if submission.status == 'done' %}
                        <span class="text-success">Đã chấm</span>
                    {% else %}
                        <span class="text-warning">Chưa chấm</span>
                    {% endif %}
                </td>
                <td>{{ submission.submit_date|date:"d M Y H:i" }}</td>
                <td>
                    {% if submission.id %}
                        <a href="{% url 'exercise_detail' class_id=class_instance.pk submission_id=submission.id %}">Chi tiết bài tập</a>
                    {% else %}
                        <span>Không có bài nộp</span>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" class="text-center">Không có bài nộp nào.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
